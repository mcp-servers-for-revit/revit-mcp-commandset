                    // 获取墙体面积
                    Parameter areaParam = wall.get_Parameter(BuiltInParameter.HOST_AREA_COMPUTED);
                    if (areaParam != null && areaParam.HasValue)
                    {
                        geometryData["area"] = areaParam.AsDouble() * 304.8 * 304.8;
                    }

                    // 获取墙体长度
                    Parameter lengthParam = wall.get_Parameter(BuiltInParameter.CURVE_ELEM_LENGTH);
                    if (lengthParam != null && lengthParam.HasValue)
                    {
                        geometryData["length"] = lengthParam.AsDouble() * 304.8;
                    }

                    // 获取墙体高度
                    Parameter heightParam = wall.get_Parameter(BuiltInParameter.WALL_USER_HEIGHT_PARAM);
                    if (heightParam != null && heightParam.HasValue)
                    {
                        geometryData["height"] = heightParam.AsDouble() * 304.8;
                    }
                }
#if REVIT2021_OR_GREATER
                else if (element is Ceiling ceiling)
                {
                    // 获取天花板面积
                    Parameter areaParam = ceiling.get_Parameter(BuiltInParameter.HOST_AREA_COMPUTED);
                    if (areaParam != null && areaParam.HasValue)
                    {
                        geometryData["area"] = areaParam.AsDouble() * 304.8 * 304.8;
                    }

                    // 获取天花板周长
                    Parameter perimeterParam = ceiling.get_Parameter(BuiltInParameter.HOST_PERIMETER_COMPUTED);
                    if (perimeterParam != null && perimeterParam.HasValue)
                    {
                        geometryData["perimeter"] = perimeterParam.AsDouble() * 304.8;
                    }
                }
#endif
            }

            // 合并基础信息和几何信息
            var result = new Dictionary<string, object>();
            foreach (var prop in basicInfo.GetType().GetProperties())
            {
                result[prop.Name] = prop.GetValue(basicInfo);
            }
            foreach (var kvp in geometryData)
            {
                result[kvp.Key] = kvp.Value;
            }

            return result;
        }

        /// <summary>
        /// 构建参数信息 - Basic + 参数
        /// </summary>
        private static object BuildParametersInfo(Document doc, Element element, FilterSetting settings)
        {
            var basicInfo = BuildBasicInfo(doc, element);

            // 提取参数
            var parameters = ExtractParameters(element, settings.ParameterOptions);

            // 合并基础信息和参数信息
            var result = new Dictionary<string, object>();
            foreach (var prop in basicInfo.GetType().GetProperties())
            {
                result[prop.Name] = prop.GetValue(basicInfo);
            }

            // 根据返回格式决定如何添加参数
            if (settings.ParameterOptions?.ReturnFormat == "Separated")
            {
                result["instanceParameters"] = parameters["instanceParameters"];
                result["typeParameters"] = parameters["typeParameters"];
            }
            else
            {
                // Merged格式
                result["parameters"] = parameters["parameters"];
            }

            return result;
        }

        /// <summary>
        /// 判断是否为定位元素（标高、轴网等）
        /// </summary>
        private static bool IsPositioningElement(Element element)
        {
            return element is Level || element is Grid;
        }

        /// <summary>
        /// 判断是否为空间元素（房间、区域等）
        /// </summary>
        private static bool IsSpatialElement(Element element)
        {
#if REVIT2020 || REVIT2021 || REVIT2022 || REVIT2023 || REVIT2024
            return element is Room || element is Area || element is Autodesk.Revit.DB.Mechanical.Space;
#else
            return element is Autodesk.Revit.DB.Architecture.Room ||
                   element is Autodesk.Revit.DB.Area ||
                   element is Autodesk.Revit.DB.Mechanical.Space;
#endif
        }

        /// <summary>
        /// 判断是否为注释元素
        /// </summary>
        private static bool IsAnnotationElement(Element element)
        {
            return element is TextNote ||
                   element is Dimension ||
                   element is DetailLine ||
                   element is DetailCurve ||
                   element is IndependentTag ||
                   element is FillPatternElement;
        }

        /// <summary>
        /// 判断是否为组或链接元素
        /// </summary>
        private static bool IsGroupOrLinkElement(Element element)
        {
            return element is Group ||
                   element is GroupType ||
                   element is RevitLinkInstance ||
                   element is RevitLinkType;
        }

        /// <summary>
        /// 构建完整信息 - 包含所有信息
        /// </summary>
        private static object BuildFullInfo(Document doc, Element element, FilterSetting settings)
        {
            // 创建一个综合的字典来存放所有信息
            var fullInfo = new Dictionary<string, object>();

            // 1. 添加基础信息
            var basicInfo = BuildBasicInfo(doc, element);
            foreach (var prop in basicInfo.GetType().GetProperties())
            {
                fullInfo[prop.Name] = prop.GetValue(basicInfo);
            }

            // 2. 添加几何信息
            var geoSettings = settings ?? new FilterSetting();
            if (geoSettings.GeometryOptions == null)
            {
                geoSettings.GeometryOptions = new GeometryOptions
                {
                    CalculateDetailedGeometry = true,
                    IncludeHandOrientation = true,
                    IncludeFacingOrientation = true,
                    IncludeIsHandFlipped = true,
                    IncludeIsFacingFlipped = true
                };
            }
            var geometryInfo = BuildGeometryInfo(doc, element, geoSettings);
            if (geometryInfo is Dictionary<string, object> geoDict)
            {
                foreach (var kvp in geoDict)
                {
                    if (!fullInfo.ContainsKey(kvp.Key))
                    {
                        fullInfo[kvp.Key] = kvp.Value;
                    }
                }
            }

            // 3. 添加参数信息
            var paramOptions = settings?.ParameterOptions ?? new ParameterOptions
            {
                Scope = "Both",
                FilterMode = "None",
                ReturnFormat = "Separated"
            };
            var parameters = ExtractParameters(element, paramOptions);
            fullInfo["instanceParameters"] = parameters["instanceParameters"];
            fullInfo["typeParameters"] = parameters["typeParameters"];

            // 4. 添加额外的Full级别字段

            // 视图状态
            if (doc.ActiveView != null)
            {
                var viewStates = new List<object>();
                bool isHidden = element.IsHidden(doc.ActiveView);
                // IsHiddenTemporary 方法可能不存在于所有版本，使用条件编译或忽略
                bool isTemporary = false;
#if REVIT2023_OR_GREATER
                // isTemporary = element.IsHiddenTemporary(doc.ActiveView);
#endif

                viewStates.Add(new
                {
                    viewId = doc.ActiveView.Id.IntegerValue,
